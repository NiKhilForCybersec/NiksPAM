<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Hardware Security Modules (HSM) Deep Dive - Architecture, deployment, and operations of enterprise HSMs">
    <title>HSM Deep Dive | PAM & KMS Guide</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="scroll-progress" id="scroll-progress"></div>

    <header class="header">
        <div class="header-content">
            <a href="../index.html" class="logo">
                <div class="logo-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                    </svg>
                </div>
                PAM & KMS Guide
            </a>
            
            <nav class="header-nav">
                <a href="pam-fundamentals.html">PAM</a>
                <a href="kms-fundamentals.html" class="active">KMS</a>
                <a href="vendors.html">Vendors</a>
                <a href="implementation.html">Implementation</a>
            </nav>
            
            <div class="header-actions">
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                    </svg>
                </button>
                <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Toggle menu">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <aside class="sidebar" id="sidebar">
        <div class="sidebar-section">
            <div class="sidebar-title">Getting Started</div>
            <ul class="sidebar-nav">
                <li><a href="../index.html">Home</a></li>
                <li><a href="introduction.html">Introduction</a></li>
            </ul>
        </div>

        <div class="sidebar-section">
            <div class="sidebar-title">PAM Fundamentals</div>
            <ul class="sidebar-nav">
                <li><a href="pam-fundamentals.html">What is PAM?</a></li>
                <li><a href="pam-business-case.html">Business Case</a></li>
            </ul>
        </div>

        <div class="sidebar-section">
            <div class="sidebar-title">KMS Fundamentals</div>
            <ul class="sidebar-nav">
                <li><a href="kms-fundamentals.html">What is KMS?</a></li>
                <li><a href="cryptographic-basics.html">Cryptographic Basics</a></li>
                <li><a href="key-lifecycle.html">Key Lifecycle</a></li>
            </ul>
        </div>

        <div class="sidebar-section">
            <div class="sidebar-title">KMS Architecture</div>
            <ul class="sidebar-nav">
                <li><a href="kms-components.html">KMS Components</a></li>
                <li><a href="hsm.html" class="active">HSM Deep Dive</a></li>
                <li><a href="cloud-kms.html">Cloud KMS</a></li>
            </ul>
        </div>

        <div class="sidebar-section">
            <div class="sidebar-title">Vendors</div>
            <ul class="sidebar-nav">
                <li><a href="vendors.html">Vendor Overview</a></li>
            </ul>
        </div>
    </aside>

    <main class="main-wrapper">
        <div class="main-content">
            <nav class="breadcrumb">
                <a href="../index.html">Home</a>
                <span class="breadcrumb-separator">/</span>
                <a href="kms-fundamentals.html">KMS Architecture</a>
                <span class="breadcrumb-separator">/</span>
                <span>HSM Deep Dive</span>
            </nav>

            <div class="page-header">
                <h1>Hardware Security Modules (HSM) Deep Dive</h1>
                <p class="page-description">
                    HSMs are the foundation of enterprise key management, providing tamper-resistant hardware protection for cryptographic keys. This page covers HSM architecture, deployment models, compliance, and operational considerations.
                </p>
            </div>

            <div class="toc">
                <div class="toc-title">On This Page</div>
                <ul class="toc-list">
                    <li><a href="#what-is-hsm"><span class="toc-number">1.</span> What is an HSM?</a></li>
                    <li><a href="#architecture"><span class="toc-number">2.</span> HSM Architecture</a></li>
                    <li><a href="#fips"><span class="toc-number">3.</span> FIPS 140 Certification</a></li>
                    <li><a href="#form-factors"><span class="toc-number">4.</span> Form Factors</a></li>
                    <li><a href="#use-cases"><span class="toc-number">5.</span> Use Cases</a></li>
                    <li><a href="#key-ceremony"><span class="toc-number">6.</span> Key Ceremony</a></li>
                    <li><a href="#high-availability"><span class="toc-number">7.</span> High Availability</a></li>
                    <li><a href="#cloud-hsm"><span class="toc-number">8.</span> Cloud HSM Options</a></li>
                    <li><a href="#vendors"><span class="toc-number">9.</span> HSM Vendors</a></li>
                </ul>
            </div>

            <section id="what-is-hsm">
                <h2>What is an HSM?</h2>
                
                <p>
                    A <strong>Hardware Security Module (HSM)</strong> is a dedicated cryptographic processor that generates, stores, and manages cryptographic keys within a physically tamper-resistant device. Keys generated inside an HSM never leave it in plaintext—all cryptographic operations happen within the protected hardware boundary.
                </p>

                <h3>Why HSMs Matter</h3>

                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                        </div>
                        <div class="feature-title">Physical Protection</div>
                        <p class="feature-description">Tamper-evident and tamper-resistant design. Attempts to physically access keys trigger zeroization (automatic key destruction).</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        </div>
                        <div class="feature-title">Keys Never Exposed</div>
                        <p class="feature-description">Private keys and master keys never exist in plaintext outside the HSM. Operations are performed inside the device.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line></svg>
                        </div>
                        <div class="feature-title">Compliance</div>
                        <p class="feature-description">HSMs meet regulatory requirements for key protection: PCI-DSS, HIPAA, eIDAS, banking regulations. FIPS 140-2/3 certification.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
                        </div>
                        <div class="feature-title">True Randomness</div>
                        <p class="feature-description">Hardware random number generators (TRNG) provide true randomness for key generation—superior to software PRNG.</p>
                    </div>
                </div>

                <div class="info-box info">
                    <svg class="info-box-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    <div class="info-box-content">
                        <h4>HSM vs. Software Key Storage</h4>
                        <p>With software storage, keys exist in server memory during operations—an attacker with root access could potentially extract them. With an HSM, even root access to the application server doesn't expose the keys, because they physically exist only inside the HSM hardware.</p>
                    </div>
                </div>
            </section>

            <section id="architecture">
                <h2>HSM Architecture</h2>

                <p>
                    HSMs share common architectural elements that provide their security guarantees.
                </p>

                <h3>Core Components</h3>

                <div class="diagram-container">
                    <div class="diagram-title">HSM Internal Architecture</div>
                    <div class="architecture-flow">
                        <div class="arch-row">
                            <div class="arch-box">
                                <div class="arch-box-title">Application</div>
                                <div class="arch-box-subtitle">PKCS#11/JCE API</div>
                            </div>
                            <div class="arch-arrow">→</div>
                            <div class="arch-box primary" style="min-width: 300px;">
                                <div class="arch-box-title">HSM Boundary</div>
                                <div class="arch-box-subtitle" style="text-align: left; padding: var(--space-2);">
                                    • Crypto Processor<br>
                                    • Secure Memory<br>
                                    • True RNG<br>
                                    • Tamper Detection<br>
                                    • Battery Backup
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <h3>Key Architectural Elements</h3>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Function</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Cryptographic Processor</strong></td>
                                <td>Dedicated processor optimized for cryptographic operations. Performs encryption, signing, key generation at high speed.</td>
                            </tr>
                            <tr>
                                <td><strong>Secure Memory</strong></td>
                                <td>Protected storage for keys and sensitive data. Contents encrypted; cleared on tamper detection.</td>
                            </tr>
                            <tr>
                                <td><strong>True Random Number Generator (TRNG)</strong></td>
                                <td>Hardware-based entropy source using physical phenomena (thermal noise, radioactive decay). Essential for key generation.</td>
                            </tr>
                            <tr>
                                <td><strong>Tamper Detection/Response</strong></td>
                                <td>Sensors detect physical intrusion, voltage manipulation, temperature extremes. Triggers zeroization.</td>
                            </tr>
                            <tr>
                                <td><strong>Battery Backup</strong></td>
                                <td>Maintains secure memory during power loss. Enables zeroization even without external power.</td>
                            </tr>
                            <tr>
                                <td><strong>Secure Boot</strong></td>
                                <td>Verified boot process ensures only authenticated firmware runs. Prevents firmware tampering.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>API Standards</h3>

                <p>
                    Applications communicate with HSMs through standardized APIs:
                </p>

                <ul>
                    <li><strong>PKCS#11 (Cryptoki):</strong> Most common standard API for cryptographic tokens. Supported by virtually all HSMs.</li>
                    <li><strong>JCE/JCA:</strong> Java Cryptography Extension—Java applications use this to access HSM capabilities.</li>
                    <li><strong>Microsoft CNG/CAPI:</strong> Windows cryptographic APIs that can interface with HSMs.</li>
                    <li><strong>OpenSSL Engine:</strong> Allows OpenSSL-based applications to use HSM for crypto operations.</li>
                    <li><strong>Vendor-specific APIs:</strong> Additional functionality beyond standards; may offer better performance.</li>
                </ul>
            </section>

            <section id="fips">
                <h2>FIPS 140 Certification</h2>

                <p>
                    <strong>FIPS 140</strong> is a U.S. government standard that defines security requirements for cryptographic modules. FIPS 140-2 has been the standard; FIPS 140-3 is the current version being adopted.
                </p>

                <h3>FIPS 140-2 Security Levels</h3>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Level</th>
                                <th>Requirements</th>
                                <th>Typical Use</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Level 1</strong></td>
                                <td>Basic security requirements. Production-grade equipment. No specific physical security.</td>
                                <td>Software crypto modules</td>
                            </tr>
                            <tr>
                                <td><strong>Level 2</strong></td>
                                <td>Tamper-evident seals. Role-based authentication. Physical security measures.</td>
                                <td>Smart cards, basic HSMs</td>
                            </tr>
                            <tr>
                                <td><strong>Level 3</strong></td>
                                <td>Tamper-resistant. Key zeroization on intrusion. Identity-based authentication. Strong physical security.</td>
                                <td><span class="badge badge-success">Most enterprise HSMs</span></td>
                            </tr>
                            <tr>
                                <td><strong>Level 4</strong></td>
                                <td>Complete physical protection envelope. Environmental failure protection. Most stringent requirements.</td>
                                <td>Military, high-security government</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="info-box info">
                    <svg class="info-box-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    <div class="info-box-content">
                        <h4>Level 3 Is the Enterprise Standard</h4>
                        <p>For most enterprise use cases, FIPS 140-2/3 Level 3 is the target. It provides strong physical protection and key zeroization while being commercially available. Level 4 is rare and typically only required for specific government/military applications. PCI-DSS requires Level 3 for payment HSMs.</p>
                    </div>
                </div>

                <h3>What FIPS 140 Certification Means</h3>

                <ul>
                    <li><strong>Validated Algorithms:</strong> Only NIST-approved cryptographic algorithms</li>
                    <li><strong>Tested by Accredited Lab:</strong> Independent testing by NVLAP-accredited laboratory</li>
                    <li><strong>Documented Security Policy:</strong> Published security policy describing module's security features</li>
                    <li><strong>Ongoing Compliance:</strong> Updates require re-certification (can take 12-24 months)</li>
                </ul>
            </section>

            <section id="form-factors">
                <h2>Form Factors</h2>

                <p>
                    HSMs come in various form factors to meet different deployment requirements.
                </p>

                <h3>Network-Attached HSM</h3>

                <div class="key-points">
                    <div class="key-points-title">Network HSM Characteristics</div>
                    <ul>
                        <li>Standalone appliance, typically 1U or 2U rack-mounted</li>
                        <li>Connects to network (Ethernet); accessible by multiple servers</li>
                        <li>High performance: thousands of operations per second</li>
                        <li>Central management; shared across applications</li>
                        <li>Examples: Thales Luna Network HSM, Entrust nShield Connect</li>
                    </ul>
                </div>

                <h3>PCIe HSM</h3>

                <div class="key-points">
                    <div class="key-points-title">PCIe HSM Characteristics</div>
                    <ul>
                        <li>PCI Express card installed inside a server</li>
                        <li>Lowest latency—direct bus connection</li>
                        <li>Dedicated to single server/application</li>
                        <li>Highest performance for single-system use cases</li>
                        <li>Examples: Thales Luna PCIe, Entrust nShield Solo</li>
                    </ul>
                </div>

                <h3>USB/Portable HSM</h3>

                <div class="key-points">
                    <div class="key-points-title">USB HSM Characteristics</div>
                    <ul>
                        <li>Small, portable device connected via USB</li>
                        <li>Used for development, key ceremony, backup</li>
                        <li>Lower performance; not for production workloads</li>
                        <li>Cost-effective entry point</li>
                        <li>Examples: YubiHSM, Thales Luna USB</li>
                    </ul>
                </div>

                <h3>Cloud HSM</h3>

                <div class="key-points">
                    <div class="key-points-title">Cloud HSM Characteristics</div>
                    <ul>
                        <li>HSM-as-a-Service provided by cloud vendors</li>
                        <li>Dedicated HSM hardware in cloud provider's data center</li>
                        <li>Managed service; no physical hardware to maintain</li>
                        <li>Integrates with cloud services (KMS, secrets managers)</li>
                        <li>Examples: AWS CloudHSM, Azure Dedicated HSM, GCP Cloud HSM</li>
                    </ul>
                </div>

                <h3>Form Factor Comparison</h3>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Form Factor</th>
                                <th>Performance</th>
                                <th>Cost</th>
                                <th>Best For</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Network HSM</strong></td>
                                <td>High (shared)</td>
                                <td>$$$</td>
                                <td>Enterprise deployment, multiple applications</td>
                            </tr>
                            <tr>
                                <td><strong>PCIe HSM</strong></td>
                                <td>Highest (dedicated)</td>
                                <td>$$</td>
                                <td>Single high-volume application</td>
                            </tr>
                            <tr>
                                <td><strong>USB HSM</strong></td>
                                <td>Low</td>
                                <td>$</td>
                                <td>Development, key ceremony, backup</td>
                            </tr>
                            <tr>
                                <td><strong>Cloud HSM</strong></td>
                                <td>High (managed)</td>
                                <td>$$/hour</td>
                                <td>Cloud workloads, avoiding hardware management</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="use-cases">
                <h2>Use Cases</h2>

                <p>
                    HSMs serve as the root of trust for various security-critical operations:
                </p>

                <h3>Primary Use Cases</h3>

                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path></svg>
                        </div>
                        <div class="feature-title">PKI / Certificate Authority</div>
                        <p class="feature-description">Protect CA private keys. Root CA key lives only in offline HSM. Issuing CA keys in network HSM.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
                        </div>
                        <div class="feature-title">Payment Processing</div>
                        <p class="feature-description">Payment HSMs for PIN processing, card verification, transaction security. Required by PCI-DSS.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                        </div>
                        <div class="feature-title">TLS/SSL Acceleration</div>
                        <p class="feature-description">HSM performs TLS handshake operations. Protects server private keys. Offloads crypto from CPU.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        </div>
                        <div class="feature-title">Database Encryption</div>
                        <p class="feature-description">Master encryption keys in HSM. TDE keys protected. Database can't decrypt data without HSM access.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                        </div>
                        <div class="feature-title">Code Signing</div>
                        <p class="feature-description">Software signing keys stored in HSM. CI/CD requests signatures without accessing private key.</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                        </div>
                        <div class="feature-title">Document Signing</div>
                        <p class="feature-description">eIDAS qualified signatures require HSM. Legal documents, contracts, regulatory filings.</p>
                    </div>
                </div>
            </section>

            <section id="key-ceremony">
                <h2>Key Ceremony</h2>

                <p>
                    A <strong>key ceremony</strong> is a formal, documented process for generating and managing critical cryptographic keys, particularly for PKI root keys and master encryption keys.
                </p>

                <h3>Why Key Ceremonies Matter</h3>

                <ul>
                    <li>Provides documented evidence of secure key generation</li>
                    <li>Ensures no single person can compromise the key</li>
                    <li>Meets audit and compliance requirements</li>
                    <li>Creates legal defensibility for the key's integrity</li>
                </ul>

                <h3>Typical Key Ceremony Process</h3>

                <div class="workflow-steps">
                    <div class="workflow-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Preparation</h4>
                            <p>Define ceremony script, gather participants (key custodians, witnesses, ceremony leader), prepare secure facility, verify HSM and smart cards.</p>
                        </div>
                    </div>

                    <div class="workflow-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>HSM Initialization</h4>
                            <p>Initialize HSM in secure mode, configure access controls, verify firmware authenticity, set up administrator credentials.</p>
                        </div>
                    </div>

                    <div class="workflow-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>Key Generation</h4>
                            <p>Generate the root/master key inside the HSM. Key never exists outside HSM. Multiple custodians required to authorize generation (M of N control).</p>
                        </div>
                    </div>

                    <div class="workflow-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>Key Backup</h4>
                            <p>Create secure backup using split knowledge. Key shares distributed to custodians on smart cards or paper. No single custodian holds complete key.</p>
                        </div>
                    </div>

                    <div class="workflow-step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <h4>Documentation</h4>
                            <p>Record every action with timestamps. Video recording optional. All participants sign ceremony log. Store documentation securely.</p>
                        </div>
                    </div>

                    <div class="workflow-step">
                        <div class="step-number">6</div>
                        <div class="step-content">
                            <h4>Secure Storage</h4>
                            <p>Key shares stored in separate secure locations (safe deposit boxes, vaults). HSM secured. Ceremony materials archived.</p>
                        </div>
                    </div>
                </div>

                <div class="info-box info">
                    <svg class="info-box-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    <div class="info-box-content">
                        <h4>M of N Control</h4>
                        <p>Key ceremonies typically use "M of N" access control—for example, 3 of 5 custodians must be present to recover or use the key. This ensures no single person (or small group of colluding individuals) can compromise the key.</p>
                    </div>
                </div>
            </section>

            <section id="high-availability">
                <h2>High Availability</h2>

                <p>
                    HSMs are often critical infrastructure—if the HSM is unavailable, dependent applications may fail. High availability designs ensure continuous operation.
                </p>

                <h3>HA Approaches</h3>

                <div class="key-points">
                    <div class="key-points-title">HSM High Availability Options</div>
                    <ul>
                        <li><strong>Active-Active Clustering:</strong> Multiple HSMs share the load. Keys replicated across HSMs. Client libraries load-balance requests.</li>
                        <li><strong>Active-Passive:</strong> Primary HSM handles requests; standby takes over on failure.</li>
                        <li><strong>Geographic Distribution:</strong> HSMs in different data centers for disaster recovery.</li>
                        <li><strong>Key Replication:</strong> Keys securely copied between HSMs in the cluster. Must use secure key wrapping.</li>
                    </ul>
                </div>

                <h3>Key Backup Strategies</h3>

                <ul>
                    <li><strong>HSM-to-HSM Backup:</strong> Key material wrapped by master backup key; restored to another HSM</li>
                    <li><strong>Smart Card Backup:</strong> Key shares stored on smart cards held by custodians</li>
                    <li><strong>Secure Key Export:</strong> Key wrapped by backup KEK; stored offline (rare for highest-value keys)</li>
                </ul>

                <div class="info-box warning">
                    <svg class="info-box-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                    <div class="info-box-content">
                        <h4>Backup Security</h4>
                        <p>HSM backups must be protected as carefully as the HSM itself. If an attacker gets a backup and the backup KEK, they have your keys. Store backup materials in separate secure locations with M of N access control.</p>
                    </div>
                </div>
            </section>

            <section id="cloud-hsm">
                <h2>Cloud HSM Options</h2>

                <p>
                    Cloud providers offer HSM-as-a-Service, providing dedicated HSM hardware without physical management.
                </p>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Service</th>
                                <th>HSM Type</th>
                                <th>FIPS Level</th>
                                <th>Key Features</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>AWS CloudHSM</strong></td>
                                <td>Dedicated single-tenant</td>
                                <td>140-2 Level 3</td>
                                <td>PKCS#11, JCE; customer-managed keys; clustering; integration with AWS services</td>
                            </tr>
                            <tr>
                                <td><strong>Azure Dedicated HSM</strong></td>
                                <td>Dedicated single-tenant</td>
                                <td>140-2 Level 3</td>
                                <td>Thales Luna HSMs; PKCS#11; customer-controlled; full HSM access</td>
                            </tr>
                            <tr>
                                <td><strong>Azure Managed HSM</strong></td>
                                <td>Dedicated (multi-tenant management)</td>
                                <td>140-2 Level 3</td>
                                <td>Fully managed; REST API; Azure Key Vault integration</td>
                            </tr>
                            <tr>
                                <td><strong>GCP Cloud HSM</strong></td>
                                <td>Multi-tenant with isolation</td>
                                <td>140-2 Level 3</td>
                                <td>Integrated with Cloud KMS; Google-managed; REST API</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Cloud HSM Considerations</h3>

                <ul>
                    <li><strong>Control:</strong> Who controls the HSM admin credentials? You or the cloud provider?</li>
                    <li><strong>Key Extraction:</strong> Can you extract keys to migrate? (Usually no, by design)</li>
                    <li><strong>Compliance:</strong> Does cloud HSM meet your regulatory requirements?</li>
                    <li><strong>Cost:</strong> Cloud HSM is priced hourly; calculate TCO vs. on-premises</li>
                    <li><strong>Latency:</strong> Network latency to cloud HSM vs. local PCIe HSM</li>
                </ul>
            </section>

            <section id="vendors">
                <h2>HSM Vendors</h2>

                <h3>Major Enterprise HSM Vendors</h3>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Vendor</th>
                                <th>Product Line</th>
                                <th>Strengths</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Thales</strong></td>
                                <td>Luna HSM (Network, PCIe, USB)</td>
                                <td>Market leader, comprehensive solution, strong compliance, used by AWS CloudHSM and Azure</td>
                            </tr>
                            <tr>
                                <td><strong>Entrust (nCipher)</strong></td>
                                <td>nShield (Connect, Solo, Edge)</td>
                                <td>Strong PKI integration, CodeSafe (secure code execution), Security World architecture</td>
                            </tr>
                            <tr>
                                <td><strong>Utimaco</strong></td>
                                <td>SecurityServer, CryptoServer</td>
                                <td>High performance, payment HSMs, German engineering</td>
                            </tr>
                            <tr>
                                <td><strong>Yubico</strong></td>
                                <td>YubiHSM 2</td>
                                <td>Affordable ($650), USB form factor, good for development and small deployments</td>
                            </tr>
                            <tr>
                                <td><strong>Futurex</strong></td>
                                <td>Vectera, Kryptus</td>
                                <td>Payment industry focus, key management solutions</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <div class="info-box success">
                <svg class="info-box-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                <div class="info-box-content">
                    <h4>Key Takeaways</h4>
                    <p>HSMs provide the highest level of key protection through tamper-resistant hardware. Keys never exist in plaintext outside the device. FIPS 140-2/3 Level 3 is the enterprise standard. Choose form factor based on deployment needs. Key ceremonies ensure secure generation of critical keys. High availability requires clustering and secure backup strategies.</p>
                </div>
            </div>

            <nav class="page-nav">
                <a href="key-lifecycle.html" class="page-nav-link prev">
                    <span class="page-nav-label">Previous</span>
                    <span class="page-nav-title">← Key Lifecycle</span>
                </a>
                <a href="cloud-kms.html" class="page-nav-link next">
                    <span class="page-nav-label">Next</span>
                    <span class="page-nav-title">Cloud KMS →</span>
                </a>
            </nav>
        </div>

        <footer class="footer">
            <p>PAM & KMS Ultimate Guide — A comprehensive enterprise security documentation resource</p>
        </footer>
    </main>

    <button class="back-to-top" id="back-to-top" aria-label="Back to top">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="18 15 12 9 6 15"></polyline>
        </svg>
    </button>

    <script src="../js/main.js"></script>
</body>
</html>
